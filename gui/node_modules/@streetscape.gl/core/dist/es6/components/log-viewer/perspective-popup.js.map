{"version":3,"sources":["../../../../src/components/log-viewer/perspective-popup.js"],"names":["React","Popup","withTheme","evaluateStyle","styled","ANCHOR_POSITION","top","x","y","bottom","left","right","PopupTip","div","props","position","width","height","margin","borderRadius","background","color","userStyle","PopupLine","borderLeftStyle","borderLeftWidth","borderColor","PopupContent","theme","__reset__","PerspectivePopup","_renderTip","positionType","anchorPosition","style","objectLabelTipSize","objectLabelColor","styleProps","tipSize","tipStyle","border","tipCircleStyle","tipLineStyle","objectLabelTip","objectLabelLine","_renderContent","_contentLoaded","objectLabelBody","children"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,KAAR,QAAoB,cAApB;AACA,SAAQC,SAAR,EAAmBC,aAAnB,QAAuC,4BAAvC;AAEA,OAAOC,MAAP,MAAmB,iBAAnB,C,CAEA;;AACA,MAAMC,eAAe,GAAG;AACtBC,EAAAA,GAAG,EAAE;AAACC,IAAAA,CAAC,EAAE,GAAJ;AAASC,IAAAA,CAAC,EAAE;AAAZ,GADiB;AAEtB,cAAY;AAACD,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE;AAAV,GAFU;AAGtB,eAAa;AAACD,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE;AAAV,GAHS;AAItBC,EAAAA,MAAM,EAAE;AAACF,IAAAA,CAAC,EAAE,GAAJ;AAASC,IAAAA,CAAC,EAAE;AAAZ,GAJc;AAKtB,iBAAe;AAACD,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE;AAAV,GALO;AAMtB,kBAAgB;AAACD,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE;AAAV,GANM;AAOtBE,EAAAA,IAAI,EAAE;AAACH,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE;AAAV,GAPgB;AAQtBG,EAAAA,KAAK,EAAE;AAACJ,IAAAA,CAAC,EAAE,CAAJ;AAAOC,IAAAA,CAAC,EAAE;AAAV;AARe,CAAxB;AAWA,MAAMI,QAAQ,GAAGR,MAAM,CAACS,GAAP,CAAWC,KAAK;AAC/BC,EAAAA,QAAQ,EAAE,UADqB;AAE/BC,EAAAA,KAAK,EAAE,CAFwB;AAG/BC,EAAAA,MAAM,EAAE,CAHuB;AAI/BC,EAAAA,MAAM,EAAE,CAAC,CAJsB;AAK/BC,EAAAA,YAAY,EAAE,CALiB;AAM/BC,EAAAA,UAAU,EAAEN,KAAK,CAACO;AANa,GAO5BlB,aAAa,CAACW,KAAK,CAACQ,SAAP,EAAkBR,KAAlB,CAPe,CAAhB,CAAjB;AAUA,MAAMS,SAAS,GAAGnB,MAAM,CAACS,GAAP,CAAWC,KAAK;AAChCC,EAAAA,QAAQ,EAAE,UADsB;AAEhCS,EAAAA,eAAe,EAAE,OAFe;AAGhCC,EAAAA,eAAe,EAAE,CAHe;AAIhCC,EAAAA,WAAW,EAAEZ,KAAK,CAACO;AAJa,GAK7BlB,aAAa,CAACW,KAAK,CAACQ,SAAP,EAAkBR,KAAlB,CALgB,CAAhB,CAAlB;AAQA,MAAMa,YAAY,GAAGvB,MAAM,CAACS,GAAP,CAAWC,KAAK,sBAChCA,KAAK,CAACc,KAAN,CAAYC,SADoB;AAEnCT,EAAAA,UAAU,EAAEN,KAAK,CAACO;AAFiB,GAGhClB,aAAa,CAACW,KAAK,CAACQ,SAAP,EAAkBR,KAAlB,CAHmB,CAAhB,CAArB;AAMA;;AACA,MAAMgB,gBAAN,SAA+B7B,KAA/B,CAAqC;AACnC8B,EAAAA,UAAU,CAACC,YAAD,EAAe;AACvB,UAAMC,cAAc,GAAG5B,eAAe,CAAC2B,YAAD,CAAtC;AADuB,wBAEA,KAAKlB,KAFL;AAAA,UAEhBc,KAFgB,eAEhBA,KAFgB;AAAA,UAETM,KAFS,eAETA,KAFS;AAAA,kCAGgDA,KAHhD,CAGhBC,kBAHgB;AAAA,UAGhBA,kBAHgB,sCAGK,EAHL;AAAA,kCAGgDD,KAHhD,CAGSE,gBAHT;AAAA,UAGSA,gBAHT,sCAG4BR,KAAK,CAACR,UAHlC;;AAKvB,UAAMiB,UAAU,qBACX,KAAKvB,KAAL,CAAWuB,UADA;AAEdT,MAAAA,KAFc;AAGdP,MAAAA,KAAK,EAAEe,gBAHO;AAIdrB,MAAAA,QAAQ,EAAEiB;AAJI,MAAhB;;AAOA,UAAMM,OAAO,GAAGnC,aAAa,CAACgC,kBAAD,EAAqBE,UAArB,CAA7B;AAEA,UAAME,QAAQ,GAAG;AACfvB,MAAAA,KAAK,EAAEsB,OADQ;AAEfrB,MAAAA,MAAM,EAAEqB,OAFO;AAGfvB,MAAAA,QAAQ,EAAE,UAHK;AAIfyB,MAAAA,MAAM,EAAE;AAJO,KAAjB;AAOA,UAAMC,cAAc,GAAG,EAAvB;AACA,UAAMC,YAAY,GAAG,EAArB;;AAEA,YAAQT,cAAc,CAAC1B,CAAvB;AACE,WAAK,GAAL;AACEkC,QAAAA,cAAc,CAAC/B,IAAf,GAAsB,KAAtB;AACAgC,QAAAA,YAAY,CAAChC,IAAb,GAAoB,KAApB;AACA;;AACF,WAAK,CAAL;AACE+B,QAAAA,cAAc,CAAC9B,KAAf,GAAuB,CAAvB;AACA+B,QAAAA,YAAY,CAAC/B,KAAb,GAAqB,CAArB;AACA;;AACF,WAAK,CAAL;AACA;AAVF;;AAaA,YAAQsB,cAAc,CAACzB,CAAvB;AACE,WAAK,GAAL;AACEkC,QAAAA,YAAY,CAAC1B,KAAb,GAAqB,MAArB;AACAyB,QAAAA,cAAc,CAACnC,GAAf,GAAqB,KAArB;AACAoC,QAAAA,YAAY,CAACpC,GAAb,GAAmB,KAAnB;AACA;;AACF,WAAK,CAAL;AACEmC,QAAAA,cAAc,CAAChC,MAAf,GAAwB,CAAxB;AACAiC,QAAAA,YAAY,CAACzB,MAAb,GAAsB,MAAtB;AACA;;AACF,WAAK,CAAL;AACA;AACEyB,QAAAA,YAAY,CAACzB,MAAb,GAAsB,MAAtB;AAZJ;;AAeA,WACE;AAAK,MAAA,GAAG,EAAC,KAAT;AAAe,MAAA,SAAS,EAAC,oBAAzB;AAA8C,MAAA,KAAK,EAAEsB;AAArD,OACE,oBAAC,QAAD;AAAU,MAAA,KAAK,EAAEE;AAAjB,OAAqCJ,UAArC;AAAiD,MAAA,SAAS,EAAEH,KAAK,CAACS;AAAlE,OADF,EAEE,oBAAC,SAAD;AAAW,MAAA,KAAK,EAAED;AAAlB,OAAoCL,UAApC;AAAgD,MAAA,SAAS,EAAEH,KAAK,CAACU;AAAjE,OAFF,CADF;AAMD;;AAEDC,EAAAA,cAAc,GAAG;AAAA,yBACoB,KAAK/B,KADzB;AAAA,UACRc,KADQ,gBACRA,KADQ;AAAA,UACDS,UADC,gBACDA,UADC;AAAA,UACWH,KADX,gBACWA,KADX;AAGf,WACE,oBAAC,YAAD;AACE,MAAA,GAAG,EAAC,SADN;AAEE,MAAA,GAAG,EAAE,KAAKY,cAFZ;AAGE,MAAA,SAAS,EAAC,wBAHZ;AAIE,MAAA,KAAK,EAAElB;AAJT,OAKMS,UALN;AAME,MAAA,KAAK,EAAEH,KAAK,CAACE,gBANf;AAOE,MAAA,SAAS,EAAEF,KAAK,CAACa;AAPnB,QASG,KAAKjC,KAAL,CAAWkC,QATd,CADF;AAaD;;AA7EkC;;AAgFrC,eAAe9C,SAAS,CAAC4B,gBAAD,CAAxB","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React from 'react';\nimport {Popup} from 'react-map-gl';\nimport {withTheme, evaluateStyle} from '@streetscape.gl/monochrome';\n\nimport styled from '@emotion/styled';\n\n// Copied from 'react-map-gl/src/utils/dynamic-position.js'\nconst ANCHOR_POSITION = {\n  top: {x: 0.5, y: 0},\n  'top-left': {x: 0, y: 0},\n  'top-right': {x: 1, y: 0},\n  bottom: {x: 0.5, y: 1},\n  'bottom-left': {x: 0, y: 1},\n  'bottom-right': {x: 1, y: 1},\n  left: {x: 0, y: 0.5},\n  right: {x: 1, y: 0.5}\n};\n\nconst PopupTip = styled.div(props => ({\n  position: 'absolute',\n  width: 4,\n  height: 4,\n  margin: -2,\n  borderRadius: 2,\n  background: props.color,\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nconst PopupLine = styled.div(props => ({\n  position: 'absolute',\n  borderLeftStyle: 'solid',\n  borderLeftWidth: 1,\n  borderColor: props.color,\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nconst PopupContent = styled.div(props => ({\n  ...props.theme.__reset__,\n  background: props.color,\n  ...evaluateStyle(props.userStyle, props)\n}));\n\n/* Like Popup but deal with z */\nclass PerspectivePopup extends Popup {\n  _renderTip(positionType) {\n    const anchorPosition = ANCHOR_POSITION[positionType];\n    const {theme, style} = this.props;\n    const {objectLabelTipSize = 30, objectLabelColor = theme.background} = style;\n\n    const styleProps = {\n      ...this.props.styleProps,\n      theme,\n      color: objectLabelColor,\n      position: positionType\n    };\n\n    const tipSize = evaluateStyle(objectLabelTipSize, styleProps);\n\n    const tipStyle = {\n      width: tipSize,\n      height: tipSize,\n      position: 'relative',\n      border: 'none'\n    };\n\n    const tipCircleStyle = {};\n    const tipLineStyle = {};\n\n    switch (anchorPosition.x) {\n      case 0.5:\n        tipCircleStyle.left = '50%';\n        tipLineStyle.left = '50%';\n        break;\n      case 1:\n        tipCircleStyle.right = 0;\n        tipLineStyle.right = 0;\n        break;\n      case 0:\n      default:\n    }\n\n    switch (anchorPosition.y) {\n      case 0.5:\n        tipLineStyle.width = '100%';\n        tipCircleStyle.top = '50%';\n        tipLineStyle.top = '50%';\n        break;\n      case 1:\n        tipCircleStyle.bottom = 0;\n        tipLineStyle.height = '100%';\n        break;\n      case 0:\n      default:\n        tipLineStyle.height = '100%';\n    }\n\n    return (\n      <div key=\"tip\" className=\"mapboxgl-popup-tip\" style={tipStyle}>\n        <PopupTip style={tipCircleStyle} {...styleProps} userStyle={style.objectLabelTip} />\n        <PopupLine style={tipLineStyle} {...styleProps} userStyle={style.objectLabelLine} />\n      </div>\n    );\n  }\n\n  _renderContent() {\n    const {theme, styleProps, style} = this.props;\n\n    return (\n      <PopupContent\n        key=\"content\"\n        ref={this._contentLoaded}\n        className=\"mapboxgl-popup-content\"\n        theme={theme}\n        {...styleProps}\n        color={style.objectLabelColor}\n        userStyle={style.objectLabelBody}\n      >\n        {this.props.children}\n      </PopupContent>\n    );\n  }\n}\n\nexport default withTheme(PerspectivePopup);\n"],"file":"perspective-popup.js"}